# å¦‚ä½•ç¼–è¯‘å›å®‰å¦å°ç¨‹åº

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼1ï¼šä¸€é”®ç¼–è¯‘ï¼ˆæ¨èï¼‰

```bash
cd /Users/zhenbosong/AreYouOK/AreYouOK-uniapp
node build.js && node post-build-fix.js
```

æˆ–ä½¿ç”¨ npm è„šæœ¬ï¼š
```bash
npm run build
```

### æ–¹å¼2ï¼šä½¿ç”¨ HBuilderX

1. åœ¨ HBuilderX ä¸­æ‰“å¼€é¡¹ç›®
2. ç‚¹å‡»"è¿è¡Œ" -> "è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨" -> "å¾®ä¿¡å¼€å‘è€…å·¥å…·"

## åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. ç‚¹å‡»"å¯¼å…¥"æˆ–"+"
3. å¡«å†™ä¿¡æ¯ï¼š
   - **é¡¹ç›®ç›®å½•**ï¼š`/Users/zhenbosong/AreYouOK/AreYouOK-uniapp/dist/dev/mp-weixin`
   - **AppID**ï¼š`wx9d3afb740a541e4e`
   - **é¡¹ç›®åç§°**ï¼šå›å®‰å¦

## å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šç¼–è¯‘åæœ‰è¯­æ³•é”™è¯¯

**ç—‡çŠ¶ï¼š**
```
Unexpected token, expected ","
this.setData({ xxx: yyy;
```

**è§£å†³æ–¹æ¡ˆï¼š**
è¿è¡Œä¿®å¤è„šæœ¬ï¼š
```bash
node post-build-fix.js
```

ç„¶ååœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡»"ç¼–è¯‘"åˆ·æ–°ã€‚

### é—®é¢˜2ï¼šä¿®å¤è„šæœ¬æŠ¥é”™

**ç—‡çŠ¶ï¼š**
```
SyntaxError: Unexpected token ')'
```

**è§£å†³æ–¹æ¡ˆï¼š**
è¿™è¯´æ˜ `post-build-fix.js` æœ¬èº«æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥è¯¥æ–‡ä»¶çš„è¯­æ³•ã€‚

### é—®é¢˜3ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·è‡ªåŠ¨é‡æ–°ç¼–è¯‘

**ç—‡çŠ¶ï¼š**
æ‰‹åŠ¨ä¿®å¤çš„æ–‡ä»¶è¢«è¦†ç›–ï¼Œé”™è¯¯åˆå‡ºç°äº†ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1. å…³é—­å¾®ä¿¡å¼€å‘è€…å·¥å…·çš„"è‡ªåŠ¨ç¼–è¯‘"åŠŸèƒ½
2. æˆ–è€…ä¿®æ”¹æº Vue æ–‡ä»¶ï¼Œç„¶åé‡æ–°è¿è¡Œç¼–è¯‘+ä¿®å¤æµç¨‹

## ç¼–è¯‘æµç¨‹è¯´æ˜

### build.js åšäº†ä»€ä¹ˆ

1. **è½¬æ¢ Vue æ¨¡æ¿ä¸º WXML**
   - `:value` â†’ `value="{{...}}"`
   - `@input` â†’ `bindinput`
   - `v-if` â†’ `wx:if`
   - ç­‰ç­‰

2. **è½¬æ¢ Vue è„šæœ¬ä¸ºå°ç¨‹åº JS**
   - `export default` â†’ `Page({`
   - `data()` â†’ `data:`
   - `methods:` ç§»é™¤
   - `this.xxx = value` â†’ `this.setData({ xxx: value })`

3. **è½¬æ¢ SCSS ä¸º WXSS**
   - ç§»é™¤ä¸æ”¯æŒçš„ CSS ç‰¹æ€§
   - å±•å¼€åµŒå¥—è¯­æ³•

### post-build-fix.js åšäº†ä»€ä¹ˆ

ä¿®å¤ `build.js` æ— æ³•æ­£ç¡®å¤„ç†çš„è¾¹ç•Œæƒ…å†µï¼š

1. `function xxx: function()` â†’ `function xxx()`
2. `this.setData({ xxx: yyy;` â†’ `this.setData({ xxx: yyy });`
3. ç§»é™¤å¤šä½™çš„æ‹¬å· `})`
4. ä¿®å¤ `return; })` â†’ `return;`

## å¼€å‘å»ºè®®

### é¿å…ä½¿ç”¨ä»¥ä¸‹è¯­æ³•

âŒ **ä¸è¦ä½¿ç”¨ v-model**
```vue
<input v-model="formData.name" />
```

âœ… **ä½¿ç”¨ :value + @input**
```vue
<input :value="formData.name" @input="onNameInput" />
```

âŒ **ä¸è¦ä½¿ç”¨ async/await**
```javascript
async method() {
  const res = await api();
}
```

âœ… **ä½¿ç”¨ Promise.then().catch()**
```javascript
method() {
  api().then(res => {
    // å¤„ç†
  }).catch(error => {
    // é”™è¯¯å¤„ç†
  });
}
```

âŒ **ä¸è¦ä½¿ç”¨å¯¹è±¡å½¢å¼çš„ class ç»‘å®š**
```vue
<view :class="{ active: isActive }"></view>
```

âœ… **ä½¿ç”¨æ•°ç»„å½¢å¼**
```vue
<view :class="['base-class', isActive ? 'active' : '']"></view>
```

### æ‰€æœ‰è¯­å¥åŠ åˆ†å·

```javascript
// æ¨è
this.loading = true;
this.userInfo = data;
return;

// ä¸æ¨èï¼ˆå¯èƒ½å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰
this.loading = true
this.userInfo = data
return
```

## æ–‡ä»¶ç»“æ„

```
AreYouOK-uniapp/
â”œâ”€â”€ pages/              # æºä»£ç ï¼ˆVue æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ index/
â”‚   â”œâ”€â”€ user/
â”‚   â””â”€â”€ sign/
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ static/             # é™æ€èµ„æº
â”œâ”€â”€ dist/               # ç¼–è¯‘è¾“å‡º
â”‚   â””â”€â”€ dev/
â”‚       â””â”€â”€ mp-weixin/  # å¾®ä¿¡å°ç¨‹åºè¾“å‡ºç›®å½•
â”œâ”€â”€ build.js            # ä¸»ç¼–è¯‘è„šæœ¬
â”œâ”€â”€ post-build-fix.js   # åå¤„ç†ä¿®å¤è„šæœ¬
â””â”€â”€ package.json        # é¡¹ç›®é…ç½®
```

## è„šæœ¬è¯´æ˜

### package.json ä¸­çš„è„šæœ¬

```json
{
  "scripts": {
    "dev:mp-weixin": "uni -p mp-weixin",
    "build:mp-weixin": "uni build -p mp-weixin",
    "build": "node build.js && node post-build-fix.js",
    "build:manual": "node build.js"
  }
}
```

- `npm run build` - ç¼–è¯‘å¹¶è‡ªåŠ¨ä¿®å¤ï¼ˆæ¨èï¼‰
- `npm run build:manual` - ä»…ç¼–è¯‘ï¼Œä¸è¿è¡Œä¿®å¤
- `npm run dev:mp-weixin` - ä½¿ç”¨ uni-app CLI ç¼–è¯‘ï¼ˆéœ€è¦å®‰è£…ï¼‰
- `npm run build:mp-weixin` - ä½¿ç”¨ uni-app CLI ç”Ÿäº§æ„å»º

## åç«¯é…ç½®

å½“å‰åç«¯åŸŸåï¼š`https://fticilgnlucq.sealoshzh.site/api`

å¦‚éœ€ä¿®æ”¹ï¼Œè¯·ç¼–è¾‘ï¼š
- `utils/api.js` - BASE_URL å¸¸é‡
- `utils/config.js` - prodConfig.baseURL

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ç¼–è¯‘åçš„ä»£ç 

ç¼–è¯‘åçš„æ–‡ä»¶åœ¨ï¼š
```
dist/dev/mp-weixin/pages/[é¡µé¢å]/index/index.js
```

å¯ä»¥ç›´æ¥æ‰“å¼€æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç ï¼Œå¸®åŠ©å®šä½é—®é¢˜ã€‚

### ä½¿ç”¨æ§åˆ¶å°

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š
1. ç‚¹å‡»"è°ƒè¯•å™¨"æ ‡ç­¾
2. æŸ¥çœ‹"Console"é¢æ¿
3. æŸ¥çœ‹é”™è¯¯å †æ ˆä¿¡æ¯

### å¸¸è§é”™è¯¯å®šä½

1. **è¯­æ³•é”™è¯¯** - æŸ¥çœ‹é”™è¯¯æç¤ºçš„è¡Œå·ï¼Œæ‰“å¼€å¯¹åº”çš„ JS æ–‡ä»¶æ£€æŸ¥
2. **æ–¹æ³•æœªå®šä¹‰** - æ£€æŸ¥ Vue æ–‡ä»¶çš„ methods ä¸­æ˜¯å¦å®šä¹‰äº†è¯¥æ–¹æ³•
3. **æ•°æ®æœªå®šä¹‰** - æ£€æŸ¥ Vue æ–‡ä»¶çš„ data() ä¸­æ˜¯å¦å®šä¹‰äº†è¯¥æ•°æ®

## æ€»ç»“

âœ… **æ¨èå·¥ä½œæµï¼š**
1. ä¿®æ”¹ Vue æºæ–‡ä»¶
2. è¿è¡Œ `node build.js && node post-build-fix.js`
3. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹æ•ˆæœ
4. å¦‚æœ‰é”™è¯¯ï¼Œæ£€æŸ¥æ§åˆ¶å°ï¼Œå®šä½é—®é¢˜
5. é‡å¤ 1-4

ğŸ¯ **è®°ä½ï¼š**
- éµå¾ªä»£ç è§„èŒƒï¼Œé¿å…ä½¿ç”¨ä¸æ”¯æŒçš„è¯­æ³•
- æ‰€æœ‰è¯­å¥åŠ åˆ†å·
- ç¼–è¯‘åè¿è¡Œä¿®å¤è„šæœ¬
- æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç å¸®åŠ©è°ƒè¯•
